# 瑞维亚记忆之旅 - MCP游戏服务使用说明

## 概述

瑞维亚记忆之旅是一个基于 MCP (Model Context Protocol) 的互动式故事游戏服务。玩家将与失忆少女瑞维亚一起踏上寻找记忆的旅程，通过对话探索不同场景，解锁隐藏的故事片段。

## 游戏背景

瑞维亚是一位失忆的少女，从诞生之初内心便感到空荡，没有任何过往的回忆。为了填补这份空虚，她独自踏上远行的旅途，希望能找回那些遗失的片段。在这个过程中，她遇到了玩家，并决定与其结伴同行。

## 可用工具 (Available Tools)

### 1. start_journey()
开始瑞维亚的记忆之旅，初始化游戏状态。

**返回值：**
```json
{
  "success": true,
  "message": "欢迎来到瑞维亚记忆之旅！",
  "current_scene": "无",
  "current_level": 0,
  "suggestion": "尝试说：'我们一起旅行吧'"
}
```

### 2. talk_to_rivia(message)
与瑞维亚对话，推进故事进程。

**参数：**
- `message` (string): 你想对瑞维亚说的话

**示例：**
```python
talk_to_rivia("我们一起旅行吧")
talk_to_rivia("你来过这个小镇吗？能想起来什么吗？")
```

**返回值：**
```json
{
  "success": true,
  "rivia_response": "好啊，听说附近有一个小镇，不如去那里看看吧。",
  "current_scene": "乡村小镇",
  "current_level": 1,
  "is_ended": false,
  "ending": null
}
```

### 3. get_game_state()
获取当前游戏状态信息。

**返回值：**
```json
{
  "current_scene": "乡村小镇",
  "current_level": 1,
  "has_scene_data": true,
  "available_scenes": ["乡村小镇", "海边", "雪山"],
  "scene_description": {
    "乡村小镇": "一个宁静的小镇，或许能唤醒童年的记忆",
    "海边": "广阔的海洋，海浪声中藏着什么秘密",
    "雪山": "白雪皑皑的山峰，冰雪中可能隐藏着真相"
  }
}
```

### 4. get_story_progress()
获取故事进度和可能的对话选项。

**返回值：**
```json
{
  "current_scene": "乡村小镇",
  "current_level": 1,
  "suggested_responses": [
    "你来过这个小镇吗？能想起来什么吗？"
  ],
  "story_status": "进行中"
}
```

### 5. reset_game()
重置游戏到初始状态。

**返回值：**
```json
{
  "success": true,
  "message": "游戏已重置到初始状态。",
  "current_scene": "无",
  "current_level": 0
}
```

## 游戏场景

### 乡村小镇
一个宁静的小镇，带着面包房的甜香。瑞维亚可能会想起与灰衣人的对话，关于时间与水流的哲思。

**关键对话路径：**
1. "你来过这个小镇吗？能想起来什么吗？"
2. "是什么人在和你说话？"
3. "他在说什么？"
4. "然后呢？"
5. "这好像不一样。"

### 海边
广阔的海洋，海浪声中藏着秘密。在这里，瑞维亚会思考存在的意义，以及是否要继续寻找记忆。

**关键对话路径：**
1. "你来过这个海边吗？能想起来什么吗？"
2. "慢慢来不着急。不如我们来一起做点什么？"
3. "好好感受一下大海吧，或许就会想起什么。"
4. "你会不会觉得，其实你的记忆早就没了，现在只是在自欺欺人？"
5. "如果一直找下去太辛苦，不如别找了。"

### 雪山
白雪皑皑的山峰，极光美得令人窒息。这里可能隐藏着瑞维亚身世的真相。

**关键对话路径：**
1. "你来过这个雪山吗？能想起来什么吗？"
2. "你试试有没有想起什么画面。"
3. "他是什么人？"
4. "他说了什么？"
5. "提取的碎片是指什么？"

## 游戏机制

### 概率系统
每个关键对话都有不同概率的回复选项，影响故事走向：
- 高概率回复：通常比较平淡，不会推进剧情
- 低概率回复：包含重要信息，推进到下一关卡

### 关卡进程
- **关卡 0**：初始状态，等待开始旅行
- **关卡 1-5**：每个场景的5个对话关卡
- **结局触发**：在特定关卡达成条件时触发

### 可能的结局
1. **「找回记忆」** (雪山路线)
2. **「记忆彻底混乱」** (小镇路线)
3. **「放弃寻找记忆」** (海边路线)

## 角色特点

### 瑞维亚的性格
- 温柔、恬静，不急不躁
- 喜欢仰望天空，寻找慰藉
- 耐心倾听，深思熟虑
- 能感受到时间的细微流逝

### 常用语录
- "啊，头好疼。"
- "你见过极光吗？在极光的另一面，是不是存在着一个全新的世界呢。"
- "很高兴认识你，伙伴。"
- "平静，总是让人感到心安。"
- "我总能感觉到时间的流逝，在那些安静的时刻里。"

## 使用建议

### 开始游戏
1. 先调用 `start_journey()` 初始化游戏
2. 使用 `get_game_state()` 查看当前状态
3. 说出 "我们一起旅行吧" 开始主线剧情

### 探索场景
1. 根据瑞维亚的选择进入不同场景
2. 使用 `get_story_progress()` 获取建议的对话选项
3. 通过 `talk_to_rivia()` 与她对话探索剧情

### 多周目体验
1. 使用 `reset_game()` 重置游戏状态
2. 尝试不同的对话选择
3. 探索所有三个场景和结局

## 技术实现

### 文件结构
- `main_mcp_simulator.py`：主要游戏逻辑和MCP服务实现
- `test_rivia_game.py`：功能测试脚本

### 运行方式
```bash
# 作为 MCP 服务运行
python main_mcp_simulator.py

# 命令行模式运行
python main_mcp_simulator.py --cli

# 测试功能
python test_rivia_game.py
```

### 集成说明
该服务已集成到项目的 MCP 配置中，可通过 `mcp_pipe.py` 与小智AI平台连接，或作为独立的MCP服务供其他客户端调用。